\usepackage[textwidth=35em,vmargin=30mm]{geometry}
\usepackage{calc,fontspec,xeCJK,xeCJKfntef,xcolor,microtype,graphicx,eso-pic,titlesec,datetime2,tocloft,paralist,enumitem}


\definecolor{DocThemePrimary}{HTML}{006BFF}
\definecolor{DocThemeSecondary}{HTML}{FF6500}



% Main frame layout hooks
\providecommand{\HookCoverStart}[0]{}
\providecommand{\HookCoverEnd}[0]{}
\providecommand{\HookCoverTitleStart}[0]{}
\providecommand{\HookCoverTitleEnd}[0]{}
\providecommand{\HookArticleTitleStart}[0]{}
\providecommand{\HookArticleTitleEnd}[0]{}





\setlength{\parindent}{0pt}
\setlength{\parskip}{7pt}

\frenchspacing
\linespread{1.1}



% Manage fonts
\setmainfont{STIX Two Text}
\setromanfont{STIX Two Text}
\setsansfont{TeX Gyre Heros}
\setmonofont{JetBrains Mono NL}
\setCJKmainfont{Noto Serif CJK SC}
\setCJKromanfont{Noto Serif CJK SC}
\setCJKsansfont{Noto Sans CJK SC}
\setCJKmonofont{Noto Sans CJK SC}
\newcommand{\neveruseseriffont}[0]{
    \setmainfont{TeX Gyre Heros}
    \setromanfont{TeX Gyre Heros}
    \setCJKmainfont{Noto Sans CJK SC}
    \setCJKromanfont{Noto Sans CJK SC}
}
\newcommand{\neverusesansfont}[0]{
    \setsansfont{STIX Two Text}
    \setCJKsansfont{Noto Serif CJK SC}
}







\makeatletter
\renewcommand{\maketitle}[0]{
    \begingroup
        \sffamily\huge\bfseries
        \HookArticleTitleStart
        \strut\@title\par
        \vskip 15pt
        \large\mdseries
        \strut\@author\hfill%
        \strut\@date\par
        \HookArticleTitleEnd
    \endgroup%
    \vskip 20pt%
    \hrule%
    \vskip 40pt
}
\newlength{\titlecovertopextramargin}
\setlength{\titlecovertopextramargin}{20mm}
\newcommand{\maketitlecover}[0]{
    \newgeometry{hmargin=43mm,bmargin=43mm,tmargin=43mm}
    \begin{titlepage}
        \leavevmode\vskip\titlecovertopextramargin
        {\color{DocThemePrimary}\rule{\linewidth}{4mm}}\par%
        \vskip 15pt%
        \HookCoverStart%
        \vskip 15pt%
        \sffamily\huge\bfseries%
        \strut\HookCoverTitleStart\@title\HookCoverTitleEnd\par%
        \vfill%
        \large\mdseries%
        \strut\@author\hfill%
        \strut\@date\par%
        \HookCoverEnd%
    \end{titlepage}
    \restoregeometry
}
\makeatother





\newcommand{\AlrightTeXChapterEnder}[0]{{\color{DocThemePrimary}\rule{70mm}{4mm}}}
\newcommand{\AlrightTeXSectionLeader}[0]{{\color{DocThemePrimary}\rule{12pt}{12pt}}\hskip 15pt}

% Chapter
\titleformat{\chapter}[display]{\sffamily\large\bfseries}%
{\sffamily\MakeUppercase{\chaptertitlename}~\thechapter}{10pt}{\sffamily\huge}%
[\vspace{0pt}\AlrightTeXChapterEnder]

% Section
\newlength{\sectionleaderwidth}
\setlength{\sectionleaderwidth}{72pt}
\titleformat{\section}[display]{\sffamily\large\bfseries}%
{}{0pt}{\sffamily\bfseries\LARGE\makebox[\sectionleaderwidth]{\AlrightTeXSectionLeader\thesection\hfill}}[]%

% Subsection
\titleformat{\subsection}[display]{\sffamily\large\bfseries}%
{}{0pt}{\sffamily\bfseries\Large\makebox[0.75\sectionleaderwidth]{\thesubsection\hfill}}[]%




\newcommand{\contentsnameplaintext}[0]{Contents}
\newcommand{\contentsnamestyle}[0]{\huge\sffamily}
\renewcommand{\contentsname}[0]{\contentsnamestyle\contentsnameplaintext}

\renewcommand{\contentsnamestyle}[0]{\sffamily\LARGE\AlrightTeXSectionLeader}
\setlength{\sectionleaderwidth}{56pt}
